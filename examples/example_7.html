
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FM Modulation &#8212; Chips 2.2.3 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="shortcut icon" href="../_static/chips.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Chips 2.2.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fm-modulation">
<h1>FM Modulation<a class="headerlink" href="#fm-modulation" title="Permalink to this headline">Â¶</a></h1>
<p>It is often useful in digital hardware to simulate a sin wave numerically. It
is possible to implements a sinusoidal oscillator, without having to calculate
the value of the sinusoid for each sample. A typical approach to this in
hardware is to store within a lookup table a series of values, and to sweep
through those values at a programmable rate. This method relies on a large
amount of memory, and the memory requirements increase rapidly for high
resolutions. It is possible to improve the resolution using techniques such as
interpolation.</p>
<p>In this example however, an alternative method is employed,
trigonometric recurrence allows us to calculate the sin and cosine of a small
angle just once. From there, subsequent samples can be found using multipliers.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;math.h&gt;</span><span class="cp"></span>

<span class="kt">unsigned</span> <span class="n">frequency_in</span> <span class="o">=</span> <span class="n">input</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="n">sin_out</span> <span class="o">=</span> <span class="n">output</span><span class="p">(</span><span class="s">&quot;sin&quot;</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="n">cos_out</span> <span class="o">=</span> <span class="n">output</span><span class="p">(</span><span class="s">&quot;cos&quot;</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">float</span> <span class="n">sin_x</span><span class="p">,</span> <span class="n">cos_x</span><span class="p">,</span> <span class="n">new_sin</span><span class="p">,</span> <span class="n">new_cos</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">frequency</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

    <span class="n">cos_x</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="n">sin_x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">M_PI</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>
    <span class="n">si</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">M_PI</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>

    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="n">fget_float</span><span class="p">(</span><span class="n">frequency_in</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">frequency</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">new_cos</span> <span class="o">=</span> <span class="n">cos_x</span><span class="o">*</span><span class="n">sr</span> <span class="o">-</span> <span class="n">sin_x</span><span class="o">*</span><span class="n">si</span><span class="p">;</span>
            <span class="n">new_sin</span> <span class="o">=</span> <span class="n">cos_x</span><span class="o">*</span><span class="n">si</span> <span class="o">+</span> <span class="n">sin_x</span><span class="o">*</span><span class="n">sr</span><span class="p">;</span>
            <span class="n">cos_x</span> <span class="o">=</span> <span class="n">new_cos</span><span class="p">;</span>
            <span class="n">sin_x</span> <span class="o">=</span> <span class="n">new_sin</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">fput_float</span><span class="p">(</span><span class="n">cos_x</span><span class="p">,</span> <span class="n">sin_out</span><span class="p">);</span>
        <span class="n">fput_float</span><span class="p">(</span><span class="n">sin_x</span><span class="p">,</span> <span class="n">cos_out</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Conveniently, using this method, both a sin and cosine wave are generated. This
is useful in complex mixers which require a coherent sin and cosine wave. We
can control the frequency of the generated wave by stepping through the
waveform more quickly. If the step rate is received from an input, this can be
used to achieve frequency modulation.</p>
<img alt="../_images/example_7.png" src="../_images/example_7.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/chips.png" alt="Logo"/>
            </a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/example_7.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Chips 2.2.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Jonathan P Dawson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>